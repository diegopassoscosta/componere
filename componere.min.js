!function(){function n(n){var e=!1;return function(){if(e)throw new Error("Callback was already called.");e=!0,n.apply(t,arguments)}}var t,e,r={};t=this,null!=t&&(e=t.async),r.noConflict=function(){return t.async=e,r};var i=Object.prototype.toString,o=Array.isArray||function(n){return"[object Array]"===i.call(n)},c=function(n,t){for(var e=0;e<n.length;e+=1)t(n[e],e,n)},a=function(n,t){if(n.map)return n.map(t);var e=[];return c(n,function(n,r,i){e.push(t(n,r,i))}),e},u=function(n,t,e){return n.reduce?n.reduce(t,e):(c(n,function(n,r,i){e=t(e,n,r,i)}),e)},s=function(n){if(Object.keys)return Object.keys(n);var t=[];for(var e in n)n.hasOwnProperty(e)&&t.push(e);return t};"undefined"!=typeof process&&process.nextTick?(r.nextTick=process.nextTick,r.setImmediate="undefined"!=typeof setImmediate?function(n){setImmediate(n)}:r.nextTick):"function"==typeof setImmediate?(r.nextTick=function(n){setImmediate(n)},r.setImmediate=r.nextTick):(r.nextTick=function(n){setTimeout(n,0)},r.setImmediate=r.nextTick),r.each=function(t,e,r){function i(n){n?(r(n),r=function(){}):(o+=1,o>=t.length&&r())}if(r=r||function(){},!t.length)return r();var o=0;c(t,function(t){e(t,n(i))})},r.forEach=r.each,r.eachSeries=function(n,t,e){if(e=e||function(){},!n.length)return e();var r=0,i=function(){t(n[r],function(t){t?(e(t),e=function(){}):(r+=1,r>=n.length?e():i())})};i()},r.forEachSeries=r.eachSeries,r.eachLimit=function(n,t,e,r){var i=l(t);i.apply(null,[n,e,r])},r.forEachLimit=r.eachLimit;var l=function(n){return function(t,e,r){if(r=r||function(){},!t.length||0>=n)return r();var i=0,o=0,c=0;!function a(){if(i>=t.length)return r();for(;n>c&&o<t.length;)o+=1,c+=1,e(t[o-1],function(n){n?(r(n),r=function(){}):(i+=1,c-=1,i>=t.length?r():a())})}()}},f=function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(null,[r.each].concat(t))}},p=function(n,t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[l(n)].concat(e))}},h=function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(null,[r.eachSeries].concat(t))}},d=function(n,t,e,r){if(t=a(t,function(n,t){return{index:t,value:n}}),r){var i=[];n(t,function(n,t){e(n.value,function(e,r){i[n.index]=r,t(e)})},function(n){r(n,i)})}else n(t,function(n,t){e(n.value,function(n){t(n)})})};r.map=f(d),r.mapSeries=h(d),r.mapLimit=function(n,t,e,r){return m(t)(n,e,r)};var m=function(n){return p(n,d)};r.reduce=function(n,t,e,i){r.eachSeries(n,function(n,r){e(t,n,function(n,e){t=e,r(n)})},function(n){i(n,t)})},r.inject=r.reduce,r.foldl=r.reduce,r.reduceRight=function(n,t,e,i){var o=a(n,function(n){return n}).reverse();r.reduce(o,t,e,i)},r.foldr=r.reduceRight;var y=function(n,t,e,r){var i=[];t=a(t,function(n,t){return{index:t,value:n}}),n(t,function(n,t){e(n.value,function(e){e&&i.push(n),t()})},function(){r(a(i.sort(function(n,t){return n.index-t.index}),function(n){return n.value}))})};r.filter=f(y),r.filterSeries=h(y),r.select=r.filter,r.selectSeries=r.filterSeries;var v=function(n,t,e,r){var i=[];t=a(t,function(n,t){return{index:t,value:n}}),n(t,function(n,t){e(n.value,function(e){e||i.push(n),t()})},function(){r(a(i.sort(function(n,t){return n.index-t.index}),function(n){return n.value}))})};r.reject=f(v),r.rejectSeries=h(v);var g=function(n,t,e,r){n(t,function(n,t){e(n,function(e){e?(r(n),r=function(){}):t()})},function(){r()})};r.detect=f(g),r.detectSeries=h(g),r.some=function(n,t,e){r.each(n,function(n,r){t(n,function(n){n&&(e(!0),e=function(){}),r()})},function(){e(!1)})},r.any=r.some,r.every=function(n,t,e){r.each(n,function(n,r){t(n,function(n){n||(e(!1),e=function(){}),r()})},function(){e(!0)})},r.all=r.every,r.sortBy=function(n,t,e){r.map(n,function(n,e){t(n,function(t,r){t?e(t):e(null,{value:n,criteria:r})})},function(n,t){if(n)return e(n);var r=function(n,t){var e=n.criteria,r=t.criteria;return r>e?-1:e>r?1:0};e(null,a(t.sort(r),function(n){return n.value}))})},r.auto=function(n,t){t=t||function(){};var e=s(n),i=e.length;if(!i)return t();var a={},l=[],f=function(n){l.unshift(n)},p=function(n){for(var t=0;t<l.length;t+=1)if(l[t]===n)return void l.splice(t,1)},h=function(){i--,c(l.slice(0),function(n){n()})};f(function(){if(!i){var n=t;t=function(){},n(null,a)}}),c(e,function(e){var i=o(n[e])?n[e]:[n[e]],l=function(n){var i=Array.prototype.slice.call(arguments,1);if(i.length<=1&&(i=i[0]),n){var o={};c(s(a),function(n){o[n]=a[n]}),o[e]=i,t(n,o),t=function(){}}else a[e]=i,r.setImmediate(h)},d=i.slice(0,Math.abs(i.length-1))||[],m=function(){return u(d,function(n,t){return n&&a.hasOwnProperty(t)},!0)&&!a.hasOwnProperty(e)};if(m())i[i.length-1](l,a);else{var y=function(){m()&&(p(y),i[i.length-1](l,a))};f(y)}})},r.retry=function(n,t,e){var i=5,o=[];"function"==typeof n&&(e=t,t=n,n=i),n=parseInt(n,10)||i;var c=function(i,c){for(var a=function(n,t){return function(e){n(function(n,r){e(!n||t,{err:n,result:r})},c)}};n;)o.push(a(t,!(n-=1)));r.series(o,function(n,t){t=t[t.length-1],(i||e)(t.err,t.result)})};return e?c():c},r.waterfall=function(n,t){if(t=t||function(){},!o(n)){var e=new Error("First argument to waterfall must be an array of functions");return t(e)}if(!n.length)return t();var i=function(n){return function(e){if(e)t.apply(null,arguments),t=function(){};else{var o=Array.prototype.slice.call(arguments,1),c=n.next();o.push(c?i(c):t),r.setImmediate(function(){n.apply(null,o)})}}};i(r.iterator(n))()};var b=function(n,t,e){if(e=e||function(){},o(t))n.map(t,function(n,t){n&&n(function(n){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),t.call(null,n,e)})},e);else{var r={};n.each(s(t),function(n,e){t[n](function(t){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),r[n]=i,e(t)})},function(n){e(n,r)})}};r.parallel=function(n,t){b({map:r.map,each:r.each},n,t)},r.parallelLimit=function(n,t,e){b({map:m(t),each:l(t)},n,e)},r.series=function(n,t){if(t=t||function(){},o(n))r.mapSeries(n,function(n,t){n&&n(function(n){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),t.call(null,n,e)})},t);else{var e={};r.eachSeries(s(n),function(t,r){n[t](function(n){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),e[t]=i,r(n)})},function(n){t(n,e)})}},r.iterator=function(n){var t=function(e){var r=function(){return n.length&&n[e].apply(null,arguments),r.next()};return r.next=function(){return e<n.length-1?t(e+1):null},r};return t(0)},r.apply=function(n){var t=Array.prototype.slice.call(arguments,1);return function(){return n.apply(null,t.concat(Array.prototype.slice.call(arguments)))}};var I=function(n,t,e,r){var i=[];n(t,function(n,t){e(n,function(n,e){i=i.concat(e||[]),t(n)})},function(n){r(n,i)})};r.concat=f(I),r.concatSeries=h(I),r.whilst=function(n,t,e){n()?t(function(i){return i?e(i):void r.whilst(n,t,e)}):e()},r.doWhilst=function(n,t,e){n(function(i){if(i)return e(i);var o=Array.prototype.slice.call(arguments,1);t.apply(null,o)?r.doWhilst(n,t,e):e()})},r.until=function(n,t,e){n()?e():t(function(i){return i?e(i):void r.until(n,t,e)})},r.doUntil=function(n,t,e){n(function(i){if(i)return e(i);var o=Array.prototype.slice.call(arguments,1);t.apply(null,o)?e():r.doUntil(n,t,e)})},r.queue=function(t,e){function i(n,t,e,i){return n.started||(n.started=!0),o(t)||(t=[t]),0==t.length?r.setImmediate(function(){n.drain&&n.drain()}):void c(t,function(t){var o={data:t,callback:"function"==typeof i?i:null};e?n.tasks.unshift(o):n.tasks.push(o),n.saturated&&n.tasks.length===n.concurrency&&n.saturated(),r.setImmediate(n.process)})}void 0===e&&(e=1);var a=0,u={tasks:[],concurrency:e,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(n,t){i(u,n,!1,t)},kill:function(){u.drain=null,u.tasks=[]},unshift:function(n,t){i(u,n,!0,t)},process:function(){if(!u.paused&&a<u.concurrency&&u.tasks.length){var e=u.tasks.shift();u.empty&&0===u.tasks.length&&u.empty(),a+=1;var r=function(){a-=1,e.callback&&e.callback.apply(e,arguments),u.drain&&u.tasks.length+a===0&&u.drain(),u.process()},i=n(r);t(e.data,i)}},length:function(){return u.tasks.length},running:function(){return a},idle:function(){return u.tasks.length+a===0},pause:function(){u.paused!==!0&&(u.paused=!0)},resume:function(){if(u.paused!==!1){u.paused=!1;for(var n=1;n<=u.concurrency;n++)r.setImmediate(u.process)}}};return u},r.priorityQueue=function(n,t){function e(n,t){return n.priority-t.priority}function i(n,t,e){for(var r=-1,i=n.length-1;i>r;){var o=r+(i-r+1>>>1);e(t,n[o])>=0?r=o:i=o-1}return r}function a(n,t,a,u){return n.started||(n.started=!0),o(t)||(t=[t]),0==t.length?r.setImmediate(function(){n.drain&&n.drain()}):void c(t,function(t){var o={data:t,priority:a,callback:"function"==typeof u?u:null};n.tasks.splice(i(n.tasks,o,e)+1,0,o),n.saturated&&n.tasks.length===n.concurrency&&n.saturated(),r.setImmediate(n.process)})}var u=r.queue(n,t);return u.push=function(n,t,e){a(u,n,t,e)},delete u.unshift,u},r.cargo=function(n,t){var e=!1,i=[],u={tasks:i,payload:t,saturated:null,empty:null,drain:null,drained:!0,push:function(n,e){o(n)||(n=[n]),c(n,function(n){i.push({data:n,callback:"function"==typeof e?e:null}),u.drained=!1,u.saturated&&i.length===t&&u.saturated()}),r.setImmediate(u.process)},process:function s(){if(!e){if(0===i.length)return u.drain&&!u.drained&&u.drain(),void(u.drained=!0);var r="number"==typeof t?i.splice(0,t):i.splice(0,i.length),o=a(r,function(n){return n.data});u.empty&&u.empty(),e=!0,n(o,function(){e=!1;var n=arguments;c(r,function(t){t.callback&&t.callback.apply(null,n)}),s()})}},length:function(){return i.length},running:function(){return e}};return u};var w=function(n){return function(t){var e=Array.prototype.slice.call(arguments,1);t.apply(null,e.concat([function(t){var e=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(t?console.error&&console.error(t):console[n]&&c(e,function(t){console[n](t)}))}]))}};r.log=w("log"),r.dir=w("dir"),r.memoize=function(n,t){var e={},i={};t=t||function(n){return n};var o=function(){var o=Array.prototype.slice.call(arguments),c=o.pop(),a=t.apply(null,o);a in e?r.nextTick(function(){c.apply(null,e[a])}):a in i?i[a].push(c):(i[a]=[c],n.apply(null,o.concat([function(){e[a]=arguments;var n=i[a];delete i[a];for(var t=0,r=n.length;r>t;t++)n[t].apply(null,arguments)}])))};return o.memo=e,o.unmemoized=n,o},r.unmemoize=function(n){return function(){return(n.unmemoized||n).apply(null,arguments)}},r.times=function(n,t,e){for(var i=[],o=0;n>o;o++)i.push(o);return r.map(i,t,e)},r.timesSeries=function(n,t,e){for(var i=[],o=0;n>o;o++)i.push(o);return r.mapSeries(i,t,e)},r.seq=function(){var n=arguments;return function(){var t=this,e=Array.prototype.slice.call(arguments),i=e.pop();r.reduce(n,e,function(n,e,r){e.apply(t,n.concat([function(){var n=arguments[0],t=Array.prototype.slice.call(arguments,1);r(n,t)}]))},function(n,e){i.apply(t,[n].concat(e))})}},r.compose=function(){return r.seq.apply(null,Array.prototype.reverse.call(arguments))};var A=function(n,t){var e=function(){var e=this,r=Array.prototype.slice.call(arguments),i=r.pop();return n(t,function(n,t){n.apply(e,r.concat([t]))},i)};if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return e.apply(this,r)}return e};r.applyEach=f(A),r.applyEachSeries=h(A),r.forever=function(n,t){function e(r){if(r){if(t)return t(r);throw r}n(e)}e()},"undefined"!=typeof module&&module.exports?module.exports=r:"undefined"!=typeof define&&define.amd?define([],function(){return r}):t.async=r}(),function(n,t){"use strict";function e(n){var t,e;document.querySelector('[src="'+n+'"]')||(t=document.getElementsByTagName("head")[0],e=document.createElement("script"),e.src=n,t.appendChild(e))}var r,i;r=100,i=function(n){if(!n)throw new Error("undefined component id.");this.id=n,this.publishes=[],this.listens=[],this.provides=[],this.requires=[],this.parents=[],this.installers=[],this.starters=[],i.components[n]=this},i.prototype.publish=function(n){if(!n)throw new Error("undefined event name.");return this.publishes.push({eventName:n}),this},i.prototype.listen=function(n,t){if(!n)throw new Error("undefined event name.");if(!t)throw new Error("undefined event connector.");return this.listens.push({eventName:n,eventConnector:t}),this},i.prototype.provide=function(n,t){if(!n)throw new Error("undefined interface name.");if(!t)throw new Error("undefined interface connector.");return this.provides.push({interfaceName:n,interfaceConnector:t}),this},i.prototype.require=function(n,t){if(!n)throw new Error("undefined interface name.");if(!t)throw new Error("undefined interface connector.");return this.requires.push({interfaceName:n,interfaceConnector:t}),this},i.prototype.extend=function(n){if(!n)throw new Error("undefined parent id.");return this.parents.push({parentId:n}),e(n),this},i.prototype.install=function(n){if(!n)throw new Error("undefined component installer.");return this.installers.push({installer:n}),this},i.prototype.start=function(n){if(!n)throw new Error("undefined component starter.");return this.starters.push({starter:n}),this},i.prototype.parentsLoaded=function(){return this.parents.every(function(n){return i.components[n.parentId]&&i.components[n.parentId].parentsLoaded()}.bind(this))},i.prototype.installInstance=function(n,e){t.series([function(e){t.each(this.parents,function(t,e){i.components[t.parentId].installInstance(n,e)}.bind(this),e)}.bind(this),function(e){t.each(this.installers,function(t,e){t.installer.apply(n,[e])}.bind(this),e)}.bind(this)],e)},i.prototype.connectInstance=function(n,e){t.series([function(e){t.each(this.parents,function(t,e){i.components[t.parentId].connectInstance(n,e)}.bind(this),e)}.bind(this),function(e){t.each(this.requires,function(t,e){var r,i;r=Instance.instances[n.element.getAttribute(t.interfaceName)],i=r.component.getConnector(t),i.interfaceConnector.call(r,function(r){t.interfaceConnector.call(n,r,e)})}.bind(this),e)}.bind(this),function(e){t.each(this.listens,function(t,e){var r=Instance.instances[n.element.getAttribute(t.eventName)];r.element.addEventListener(t.eventName,t.eventConnector.bind(n)),e()}.bind(this),e)}.bind(this)],e)},i.prototype.getConnector=function(n){var t,e,r;for(t=0;t<this.provides.length;t++)if(this.provides[t].interfaceName===n.interfaceName)return this.provides[t];for(t=0;t<this.parents.length;t++)if(e=i.components[this.parents[t].parentId],r=e.getConnector(n))return r},i.prototype.startInstance=function(n,e){t.series([function(e){t.each(this.parents,function(t,e){i.components[t.parentId].startInstance(n,e)}.bind(this),e)}.bind(this),function(e){t.each(this.starters,function(t,e){t.starter.apply(n,[e])}.bind(this),e)}.bind(this)],e)},i.loadComponents=function(){var n=document.querySelectorAll("component:not([component-load])");Array.prototype.forEach.call(n,function(n){n.setAttribute("component-load","true"),e(n.getAttribute("type"))})},i.components={},n.setInterval(i.loadComponents,r),n.Component=i}(window,async),function(n,t){"use strict";var e,r;e=100,r=function(n,t){if(!n)throw new Error("undefined instance component.");if(!t)throw new Error("undefined instance element.");this.component=n,this.element=t,this.id=t.getAttribute("id"),this.status="loaded",r.instances[this.id]=this},r.prototype.canInstall=function(){return"loaded"===this.status&&this.component.parentsLoaded()},r.prototype.canConnect=function(){return"installed"===this.status&&this.component.requires.every(function(n){var t=r.instances[this.element.getAttribute(n.interfaceName)];return t&&"loaded"!==t.status&&"installing"!==t.status}.bind(this))&&this.component.listens.every(function(n){var t=r.instances[this.element.getAttribute(n.eventName)];return t&&"loaded"!==t.status&&"installing"!==t.status}.bind(this))},r.prototype.canStart=function(){return"connected"===this.status},r.prototype.install=function(n){this.canInstall()&&t.series([function(n){this.status="installing",n()}.bind(this),function(n){this.component.installInstance(this,n)}.bind(this),function(n){this.status="installed",n()}.bind(this)],n)},r.prototype.connect=function(n){this.canConnect()&&t.series([function(n){this.status="connecting",n()}.bind(this),function(n){this.component.connectInstance(this,n)}.bind(this),function(n){this.status="connected",n()}.bind(this)],n)},r.prototype.start=function(n){this.canStart()&&t.series([function(n){this.status="starting",this.component.publishes.forEach(function(n){this[n.eventName]=function(t){var e=new CustomEvent(n.eventName,{detail:t});this.element.dispatchEvent(e)}.bind(this)}.bind(this)),n()}.bind(this),function(n){this.component.startInstance(this,n)}.bind(this),function(n){this.status="started",n()}.bind(this)],n)},r.loadInstances=function(){var n=document.querySelectorAll("component:not([instance-load])");Array.prototype.filter.call(n,function(n){var t;t=Component.components[n.getAttribute("type")],t&&(n.setAttribute("instance-load","true"),new r(t,n))})},r.installInstances=function(){for(var n in r.instances)r.instances.hasOwnProperty(n)&&r.instances[n].install()},r.connectInstances=function(){for(var n in r.instances)r.instances.hasOwnProperty(n)&&r.instances[n].connect()},r.startInstances=function(){for(var n in r.instances)r.instances.hasOwnProperty(n)&&r.instances[n].start()},r.instances={},n.setInterval(r.loadInstances,e),n.setInterval(r.installInstances,e),n.setInterval(r.connectInstances,e),n.setInterval(r.startInstances,e),n.Instance=r}(window,async);
