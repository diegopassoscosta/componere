(function(e){"use strict";var t,n,r,i;i=100;n=[];r=[];t=function(e){if(!e){throw new Error("undefined component URI.")}if(t.findComponent(e)){throw new Error("repeated component URI.")}this.uri=e;this.listens=[];this.publishes=[];this.provides=[];this.requires=[];this.extends=[];this.installs=[];this.starts=[];n.push(this)};t.prototype.listen=function(e,t){if(!e){throw new Error("undefined event name.")}if(!t){throw new Error("undefined event listener.")}this.listens.push({eventName:e,eventListener:t});return this};t.prototype.publish=function(e){if(!e){throw new Error("undefined event name.")}this.publishes.push({eventName:e});return this};t.prototype.provide=function(e,t){if(!e){throw new Error("undefined interface name.")}if(!t){throw new Error("undefined interface provider.")}this.provides.push({interfaceName:e,interfaceProvider:t});return this};t.prototype.require=function(e,t){if(!e){throw new Error("undefined interface name.")}if(!t){throw new Error("undefined interface connector.")}this.requires.push({interfaceName:e,interfaceConnector:t});return this};t.prototype.extend=function(e){var t,n;if(!e){throw new Error("undefined parent uri.")}this.extends.push({parentUri:e});if(!document.querySelector('[src="'+e+'"]')){t=document.getElementsByTagName("head")[0];n=document.createElement("script");n.src=e;t.appendChild(n)}return this};t.prototype.install=function(e){if(!e){throw new Error("undefined component installer.")}this.installs.push({componentInstaller:e});return this};t.prototype.start=function(e){if(!e){throw new Error("undefined component starter.")}this.starts.push({componentStarter:e});return this};t.prototype.readyToStart=function(e){if(!e){throw new Error("undefined component instance.")}return this.requires.every(function(n){return!!t.findInstance(e.element.getAttribute(n.interfaceName))})&&this.listens.every(function(n){return!!t.findInstance(e.element.getAttribute(n.eventName))})};t.prototype.readyToInstall=function(){return!!t.findComponent(this.uri)&&this.extends.every(function(e){return t.findComponent(e.parentUri)})};t.prototype.startInstance=function(e){if(!e){throw new Error("undefined component instance.")}this.requires.forEach(function(n){var r=t.findInstance(e.element.getAttribute(n.interfaceName));n.interfaceConnector.apply(e,[r.interfaces[n.interfaceName]])});this.listens.forEach(function(n){var r=t.findInstance(e.element.getAttribute(n.eventName));r.element.addEventListener(n.eventName,n.eventListener.bind(e))});this.starts.forEach(function(t){t.componentStarter.apply(e,[])});e.started=true;return e};t.prototype.installInstance=function(e,n){if(!e){throw new Error("undefined dom element.")}if(!n){throw new Error("undefined id.")}var r={};r.interfaces={};this.extends.forEach(function(i){var s=t.findComponent(i.parentUri).installInstance(e,n);for(var o in s){r[o]=s[o]}});this.installs.forEach(function(t){t.componentInstaller.apply(r,[e])});this.publishes.forEach(function(t){var n=new Event(t.eventName);r[t.eventName]=function(){e.dispatchEvent(n)}});this.provides.forEach(function(e){r.interfaces[e.interfaceName]=e.interfaceProvider.apply(r,[])});r.id=n;r.component=this;r.started=false;r.element=e;return r};t.findComponent=function(e){if(!e){throw new Error("undefined component URI.")}return n.filter(function(t){return t.uri===e}).pop()};t.findInstance=function(e){if(!e){throw new Error("undefined instance id.")}return r.filter(function(t){return t.id===e}).pop()};t.seekComponentsToStart=function(){r.filter(function(e){return!e.started&&e.component.readyToStart(e)}).forEach(function(e){e.component.startInstance(e)})};t.seekComponentsToInstall=function(){var e,n,i,s,o,u;e=document.querySelectorAll("component:not([installed])");for(n=0;n<e.length;n+=1){i=e[n];o=e[n].getAttribute("type");s=e[n].getAttribute("id");if(!o){throw new Error("undefined component type.")}if(!s){throw new Error("undefined component id.")}u=t.findComponent(o);if(u&&u.readyToInstall()){i.setAttribute("installed",true);r.push(u.installInstance(e[n],s))}}};t.seekComponentsToLoad=function(){var e,t,n,r,i,s;e=document.getElementsByTagName("head")[0];t=document.querySelectorAll("component:not([loading])");for(n=0;n<t.length;n+=1){r=t[n];i=r.getAttribute("type");if(!i){throw new Error("undefined component type.")}if(!document.querySelector('[src="'+i+'"]')){r.setAttribute("loading",true);s=document.createElement("script");s.src=i;e.appendChild(s)}}};e.setInterval(t.seekComponentsToStart,i);e.setInterval(t.seekComponentsToInstall,i);e.setInterval(t.seekComponentsToLoad,i);e.Component=t})(window)